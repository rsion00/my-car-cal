<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ä¸­å¤è»Šè¨ˆç®—ãƒ„ãƒ¼ãƒ«</title>
    <style>
        :root { --main-color: #3498db; --bg-color: #f4f7f6; --text-color: #333; --accent-color: #e67e22; --warranty-color: #27ae60; --pack-color: #9b59b6; }
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; background-color: var(--bg-color); padding: 10px; color: var(--text-color); margin: 0; line-height: 1.4; padding-bottom: 100px; }
        .container { max-width: 500px; margin: auto; background: white; padding: 15px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); }
        h1 { text-align: center; font-size: 1.1rem; color: #2c3e50; margin-top: 5px; }
        .section { margin-bottom: 12px; border: 1px solid #edf2f7; padding: 12px; border-radius: 10px; }
        .section-title { font-weight: bold; font-size: 0.85rem; color: var(--main-color); margin-bottom: 10px; border-left: 4px solid var(--main-color); padding-left: 8px; }
        
        /* æ ã”ã¨ã®è‰²åˆ†ã‘ */
        .warranty-section { border: 2px solid var(--warranty-color); }
        .warranty-section .section-title { color: var(--warranty-color); border-left-color: var(--warranty-color); }
        .pack-section { border: 2px solid var(--pack-color); }
        .pack-section .section-title { color: var(--pack-color); border-left-color: var(--pack-color); }

        .row { display: flex; align-items: center; margin-bottom: 10px; justify-content: space-between; gap: 10px; }
        label { font-size: 0.8rem; font-weight: 600; flex: 1; }
        input[type="number"], select { width: 130px; padding: 10px; border: 1px solid #cbd5e0; border-radius: 6px; text-align: right; font-size: 0.95rem; -webkit-appearance: none; background-color: white; }
        input[readonly] { background-color: #f8fafc; color: #64748b; border: 1px solid #e2e8f0; }
        
        .radio-group { display: flex; gap: 4px; flex-wrap: wrap; }
        .radio-group label { flex: none; }
        .radio-group input { display: none; }
        .radio-group span { display: inline-block; padding: 8px 10px; background: #edf2f7; border-radius: 6px; font-size: 0.7rem; cursor: pointer; border: 1px solid #e2e8f0; text-align: center; min-width: 60px; }
        
        /* è»Šä¸¡åŒºåˆ†é¸æŠã®è‰² */
        .type-group input:checked + span { background: var(--main-color); color: white; border-color: var(--main-color); }
        /* ä¿è¨¼ç”¨ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®è‰² */
        .warranty-group input:checked + span { background: var(--warranty-color); color: white; border-color: var(--warranty-color); }
        /* ãƒ‘ãƒƒã‚¯ç”¨ãƒ©ã‚¸ã‚ªãƒœã‚¿ãƒ³ã®è‰² */
        .pack-group input:checked + span { background: var(--pack-color); color: white; border-color: var(--pack-color); }

        .tax-display { font-size: 0.75rem; color: #718096; text-align: right; margin-top: -5px; margin-bottom: 5px; }
        .link-button { display: inline-block; padding: 6px 12px; background-color: var(--accent-color); color: white; text-decoration: none; font-size: 0.7rem; border-radius: 6px; }
        
        .total-box { position: fixed; bottom: 0; left: 0; right: 0; background: #2d3748; color: white; padding: 15px; text-align: center; box-shadow: 0 -5px 15px rgba(0,0,0,0.2); z-index: 1000; }
        .total-label { font-size: 0.8rem; opacity: 0.9; margin-bottom: 2px; }
        .total-amount { font-size: 1.8rem; font-weight: bold; color: #63b3ed; }
        .info-text { font-size: 0.65rem; color: #718096; margin-top: 3px; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸš— ä¸­å¤è»ŠãŠè¦‹ç©ã‚Šè¨ˆç®—</h1>

    <!-- 1. è»Šä¸¡åŒºåˆ†ï¼ˆã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ãƒ»ãƒ‘ãƒƒã‚¯ãƒ»åˆ©ç›Šé€£å‹•ï¼‰ -->
    <div class="section" style="background: #ebf8ff;">
        <div class="section-title">1. è»Šä¸¡ã‚¿ã‚¤ãƒ—ï¼ˆã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°ãƒ»åˆ©ç›Šãƒ»ãƒ‘ãƒƒã‚¯é€£å‹•ï¼‰</div>
        <div class="radio-group type-group">
            <label><input type="radio" name="carType" value="light" onclick="calculate()" checked> <span>è»½è‡ªå‹•è»Š</span></label>
            <label><input type="radio" name="carType" value="compact" onclick="calculate()"> <span>ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆ(<2.0L)</span></label>
            <label><input type="radio" name="carType" value="medium" onclick="calculate()"> <span>ãƒŸãƒ‡ã‚£ã‚¢ãƒ (2.0-2.5L)</span></label>
        </div>
    </div>

    <!-- 2. ä»•å…¥ã‚Œ -->
    <div class="section">
        <div class="section-title">2. ä»•å…¥ã‚Œï¼ˆèª²ç¨å¯¾è±¡ï¼‰</div>
        <div class="row"><label>æœ¬ä½“è½æœ­ä¾¡æ ¼</label><input type="number" id="basePrice" value="0" oninput="calculate()"></div>
        <div class="row"><label>è½æœ­è²»ç”¨</label><input type="number" id="auctionFee" value="0" oninput="calculate()"></div>
        <div class="row"><label>é™¸é€è²»ç”¨</label><input type="number" id="transportFee" value="0" oninput="calculate()"></div>
        <div class="tax-display">ä»•å…¥ã‚Œæ¶ˆè²»ç¨(10%): <span id="taxAmount">0</span> å††</div>
    </div>

    <!-- 3. æ•´å‚™ãƒ»åŠ ä¿® -->
    <div class="section">
        <div class="section-title">3. æ•´å‚™ãƒ»åŠ ä¿®</div>
        <div class="row"><label>ã‚¯ãƒªãƒ¼ãƒ‹ãƒ³ã‚°è²»</label><input type="number" id="cleaningFee" value="12000" readonly></div>
        <div class="row"><label>éˆ‘é‡‘è²»ç”¨</label><input type="number" id="repairFee" value="0" oninput="calculate()"></div>
        <div class="row"><label>è»Šæ¤œæ•´å‚™(ã‚¿ã‚¤ãƒ¤è¾¼)</label><input type="number" id="maintenanceFee" value="0" oninput="calculate()"></div>
    </div>

    <!-- 4. ä¿è¨¼ï¼ˆåˆ¥ä¼šç¤¾å§”è¨—ï¼‰ -->
    <div class="section warranty-section">
        <div class="section-title">4. ä¿è¨¼è²»ç”¨ï¼ˆMãƒ—ãƒ©ãƒ³ï¼šå§”è¨—å…ˆåŸºæº–ï¼‰</div>
        <div class="row">
            <label>ä¿è¨¼ç”¨ æ’æ°—é‡åŒºåˆ†</label>
            <div class="radio-group warranty-group">
                <label><input type="radio" name="wType" value="wLight" onclick="calculate()" checked> <span>è»½è‡ªå‹•è»Š</span></label>
                <label><input type="radio" name="wType" value="w1800" onclick="calculate()"> <span>ã€œ1.8L</span></label>
                <label><input type="radio" name="wType" value="wOver" onclick="calculate()"> <span>1.8Lã€œ</span></label>
            </div>
        </div>
        <div class="row">
            <label>èµ°è¡Œè·é›¢</label>
            <select id="mileage" onchange="calculate()">
                <option value="40000">ã€œ40,000km</option>
                <option value="60000">ã€œ60,000km</option>
                <option value="80000">ã€œ80,000km</option>
                <option value="110000">ã€œ110,000km</option>
                <option value="150000">ã€œ150,000km</option>
            </select>
        </div>
        <div class="row">
            <label>ä¿è¨¼æœŸé–“</label>
            <select id="warrantyTerm" onchange="calculate()">
                <option value="24">24ãƒ¶æœˆ</option><option value="30">30ãƒ¶æœˆ</option><option value="36">36ãƒ¶æœˆ</option>
                <option value="42">42ãƒ¶æœˆ</option><option value="48">48ãƒ¶æœˆ</option><option value="54">54ãƒ¶æœˆ</option>
                <option value="60">60ãƒ¶æœˆ</option><option value="66">66ãƒ¶æœˆ</option><option value="72">72ãƒ¶æœˆ</option>
            </select>
        </div>
        <div class="row"><label>ç®—å‡ºä¿è¨¼æ–™</label><input type="number" id="warrantyFee" value="0" readonly></div>
        <div class="info-text" id="warrantyInfo"></div>
    </div>

    <!-- 5. è«¸è²»ç”¨ãƒ»ç¨é‡‘ -->
    <div class="section">
        <div class="section-title">5. è«¸è²»ç”¨ãƒ»ç¨é‡‘</div>
        <div class="row"><label>è«¸è²»ç”¨(è‡ªå‹•è»Šç¨ç­‰)</label><input type="number" id="registrationFee" value="0" oninput="calculate()"></div>
        <div class="row"><label>ç’°å¢ƒæ€§èƒ½å‰²ç¨</label><input type="number" id="envTax" value="0" oninput="calculate()"></div>
        <div style="text-align: right; margin-bottom: 5px;"><a href="https://www.jucda.or.jp/tax/kankyouseinouwari/" target="_blank" class="link-button">ç’°å¢ƒæ€§èƒ½å‰² è¨ˆç®—ã‚µã‚¤ãƒˆ â†—</a></div>
    </div>

    <!-- 6. ãŠã¾ã‹ã›ãƒ‘ãƒƒã‚¯ -->
    <div class="section pack-section">
        <div class="section-title">6. ãŠã¾ã‹ã›ãƒ‘ãƒƒã‚¯ï¼ˆè»Šç¨®é€£å‹•ï¼‰</div>
        <div class="row">
            <label>ãƒ‘ãƒƒã‚¯æœŸé–“</label>
            <div class="radio-group pack-group">
                <label><input type="radio" name="packYear" value="0" onclick="calculate()" checked> <span>ãªã—</span></label>
                <label><input type="radio" name="packYear" value="2" onclick="calculate()"> <span>2å¹´</span></label>
                <label><input type="radio" name="packYear" value="4" onclick="calculate()"> <span>4å¹´</span></label>
                <label><input type="radio" name="packYear" value="6" onclick="calculate()"> <span>6å¹´</span></label>
            </div>
        </div>
        <div class="row"><label>ãƒ‘ãƒƒã‚¯æ–™é‡‘å†…è¨³</label><input type="number" id="servicePackDisplay" value="0" readonly></div>
        <div class="info-text" id="packInfo"></div>
    </div>

    <!-- 7. åˆ©ç›Š -->
    <div class="section">
        <div class="section-title">7. è²©å£²åˆ©ç›Š</div>
        <div class="row"><label>è»Šä¸¡åˆ©ç›Š</label><input type="number" id="profit" value="150000" oninput="calculate()"></div>
    </div>

    <!-- åˆè¨ˆï¼ˆä¸‹éƒ¨å›ºå®šï¼‰ -->
    <div class="total-box">
        <div class="total-label">ãŠæ”¯æ‰•ç·é¡ï¼ˆä¹—ã‚Šå‡ºã—ä¾¡æ ¼ï¼‰</div>
        <div class="total-amount">Â¥ <span id="totalDisplay">0</span></div>
    </div>
</div>

<script>
    // ä¿è¨¼æ–™ãƒ‡ãƒ¼ã‚¿ï¼ˆç¨è¾¼ï¼‰
    const warrantyData = {
        'wLight': { // è»½è‡ªå‹•è»Š
            '40000': { 24: 49940, 30: 51920, 36: 53900, 42: 57530, 48: 60610, 54: 65560, 60: 69740, 66: 75460, 72: 85030 },
            '60000': { 24: 55880, 30: 58850, 36: 61820, 42: 67210, 48: 72050, 54: 82830, 60: 95150, 66: 112090, 72: 127600 },
            '80000': { 24: 64020, 30: 68750, 36: 72930, 42: 85580, 48: 99990, 54: 121220, 60: 139700, 66: 164450, 72: 187000 },
            '110000': { 24: 75460, 30: 87890, 36: 100210, 42: 122540, 48: 143000, 54: 173580, 60: 199870 }
        },
        'w1800': { // 1,800ccä»¥ä¸‹
            '40000': { 24: 50050, 30: 51810, 36: 53020, 42: 55660, 48: 58080, 54: 62040, 60: 65340, 66: 68970, 72: 72270 },
            '60000': { 24: 54780, 30: 57310, 36: 59180, 42: 62810, 48: 66110, 54: 71610, 60: 76670, 66: 86790, 72: 95920 },
            '80000': { 24: 62150, 30: 65670, 36: 68200, 42: 73370, 48: 80520, 54: 96140, 60: 109560, 66: 123970, 72: 137170 },
            '110000': { 24: 71830, 30: 77440, 36: 84590, 42: 99220, 48: 112640, 54: 134640, 60: 153340 },
            '150000': { 24: 91630, 30: 105050, 36: 114950, 42: 134640, 48: 152900, 54: 182710, 60: 208010 }
        },
        'wOver': { // 1,801ccä»¥ä¸Š
            '40000': { 24: 52690, 30: 56100, 36: 60060, 42: 66770, 48: 72930, 54: 85800, 60: 99440, 66: 115940, 72: 130570 },
            '60000': { 24: 61490, 30: 67100, 36: 73260, 42: 92180, 48: 111650, 54: 137170, 60: 159170, 66: 185460, 72: 209000 },
            '80000': { 24: 74030, 30: 89100, 36: 108130, 42: 141020, 48: 171050, 54: 210320, 60: 243650, 66: 268510, 72: 286550 },
            '110000': { 24: 106040, 30: 130900, 36: 158730, 42: 207020, 48: 251240, 54: 281050, 60: 305690 },
            '150000': { 24: 150370, 30: 185240, 36: 224950, 42: 273130, 48: 304590, 54: 345290, 60: 380270 }
        }
    };

    function calculate() {
        const carType = document.querySelector('input[name="carType"]:checked').value;
        const wType = document.querySelector('input[name="wType"]:checked').value;
        const packYear = parseInt(document.querySelector('input[name="packYear"]:checked').value);
        const mileage = document.getElementById('mileage').value;
        const term = document.getElementById('warrantyTerm').value;
        
        const cleaningInput = document.getElementById('cleaningFee');
        const profitInput = document.getElementById('profit');
        const packDisplay = document.getElementById('servicePackDisplay');
        const packInfo = document.getElementById('packInfo');
        const warrantyInput = document.getElementById('warrantyFee');
        const warrantyInfo = document.getElementById('warrantyInfo');

        // 1. è»Šä¸¡åŒºåˆ†é€£å‹•è¨­å®š
        let cleaning = 12000, profit = 150000, packBase = 57900;
        if (carType === 'compact') { cleaning = 15000; profit = 200000; packBase = 65600; }
        if (carType === 'medium') { cleaning = 20000; profit = 200000; packBase = 71300; }

        cleaningInput.value = cleaning;
        // åˆ©ç›ŠãŒåˆæœŸå€¤ã®ã¾ã¾ã§ã‚ã‚Œã°è‡ªå‹•ã‚»ãƒƒãƒˆ
        if (profitInput.value == 150000 || profitInput.value == 200000 || profitInput.value == 0) {
            profitInput.value = profit;
        }

        // 2. ãŠã¾ã‹ã›ãƒ‘ãƒƒã‚¯è¨ˆç®—ï¼ˆ2å¹´ã‚’1å€ã€4å¹´ã‚’2å€ã€6å¹´ã‚’3å€ï¼‰
        let packTotal = packYear === 0 ? 0 : packBase * (packYear / 2);
        packDisplay.value = packTotal;
        packInfo.innerText = packYear > 0 ? `${carType === 'light' ? 'è»½' : carType === 'compact' ? 'ã‚³ãƒ³ãƒ‘ã‚¯ãƒˆ' : 'ãƒŸãƒ‡ã‚£ã‚¢ãƒ '}ï¼š2å¹´å˜ä¾¡ ${packBase.toLocaleString()}å††ã®${packYear/2}å€` : "";

        // 3. ä¿è¨¼æ–™è¨ˆç®—ï¼ˆå§”è¨—å…ˆåŒºåˆ†ã‚’ä½¿ç”¨ï¼‰
        let fee = 0;
        const typeData = warrantyData[wType];
        if (typeData && typeData[mileage] && typeData[mileage][term]) {
            fee = typeData[mileage][term];
            warrantyInfo.innerText = "æ–™é‡‘è¡¨ã‹ã‚‰ç®—å‡ºå®Œäº†";
            warrantyInfo.style.color = "#27ae60";
        } else {
            fee = 0;
            warrantyInfo.innerText = "â€»è©²å½“ãªã—ï¼ˆå¯¾è±¡å¤–ï¼‰";
            warrantyInfo.style.color = "#e74c3c";
        }
        warrantyInput.value = fee;

        // 4. åˆè¨ˆè¨ˆç®—
        const getVal = (id) => parseInt(document.getElementById(id).value) || 0;
        const basePrice = getVal('basePrice');
        const auctionFee = getVal('auctionFee');
        const transportFee = getVal('transportFee');

        const taxBase = basePrice + auctionFee + transportFee;
        const tax = Math.floor(taxBase * 0.1);
        document.getElementById('taxAmount').innerText = tax.toLocaleString();

        const total = taxBase + tax + cleaning + getVal('repairFee') + getVal('maintenanceFee') + 
                      getVal('registrationFee') + getVal('envTax') + packTotal + fee + getVal('profit');

        document.getElementById('totalDisplay').innerText = total.toLocaleString();
    }
    calculate();
</script>

</body>
</html>